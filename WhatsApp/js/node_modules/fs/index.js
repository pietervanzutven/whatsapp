require((exports, module) => {

    const values = Windows.Storage.ApplicationData.current.localSettings.values;
    const localFolder = Windows.Storage.ApplicationData.current.localFolder;

    const files = {};
    const memory = {};
    let timers = {};

    module.exports = {
        async prepareFileAsync(filename) {
            const file = await localFolder.createFileAsync(filename, Windows.Storage.CreationCollisionOption.openIfExists);
            const data = await Windows.Storage.FileIO.readTextAsync(file);

            files[filename] = file;
            memory[filename] = data;
        },

        readFileSync(filename, options) {
            return memory[filename];
        },

        writeFileSync(filename, data) {
            memory[filename] = data;
            
            if (timers[filename]) {
                clearTimeout(timers[filename]);
            }

            timers[filename] = setTimeout(() => Windows.Storage.FileIO.writeTextAsync(files[filename], data), 1000);
        },

        existsSync(filename) {
            if (memory[filename]) {
                return true;
            }
            return false;
        }
    }
});